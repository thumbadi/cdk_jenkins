import unittest
import boto3

class TestGlueJob(unittest.TestCase):
    
    def setUp(self):
        self.glue = boto3.client('glue')
        self.job_name = 'my_glue_job'
    
    def test_glue_job_success(self):
        response = self.glue.start_job_run(
            JobName=self.job_name
        )
        job_run_id = response['JobRunId']
        
        status = None
        while status not in ['SUCCEEDED', 'FAILED']:
            response = self.glue.get_job_run(
                JobName=self.job_name,
                RunId=job_run_id
            )
            status = response['JobRun']['JobRunState']
        
        self.assertEqual(status, 'SUCCEEDED')
    
    def test_glue_job_failure(self):
        response = self.glue.start_job_run(
            JobName=self.job_name
        )
        job_run_id = response['JobRunId']
        
        status = None
        while status not in ['SUCCEEDED', 'FAILED']:
            response = self.glue.get_job_run(
                JobName=self.job_name,
                RunId=job_run_id
            )
            status = response['JobRun']['JobRunState']
        
        self.assertEqual(status, 'FAILED')



-------------

# install unittest and boto3 python packages
```
pip install unittest
pip install boto3
```
# configure the aws credentials
```
aws configure
```

# change the name of your aws glue job on the py file 


# run the below command to test that
```
python -m unittest unit_test.py
```
